FROM node:10
WORKDIR /app
WORKDIR /app
COPY package.json ./package.json
COPY data-to-code-api/package.json ./data-to-code-api/package.json
COPY data-to-code-api-objects/package.json ./data-to-code-api-objects/package.json
COPY data-to-code-prod-ui/package.json ./data-to-code-prod-ui/package.json
COPY data-to-code-console/package.json ./data-to-code-console/package.json
COPY data-to-code-objects/package.json ./data-to-code-objects/package.json
COPY data-to-code-objects-test/package.json ./data-to-code-objects-test/package.json
COPY yarn.lock ./yarn.lock

RUN yarn install 

COPY . ./

RUN npm install --global typedoc
RUN yarn build
RUN typedoc --mode file --out docs/source/data-to-code-api --ignoreCompilerErrors  --excludePrivate --excludeProtected data-to-code-api/src
RUN typedoc --mode file --out docs/source/data-to-code-api-objects --ignoreCompilerErrors  --excludePrivate --excludeProtected data-to-code-api-objects/src
RUN typedoc --mode file --out docs/source/data-to-code-prod-ui --ignoreCompilerErrors  --excludePrivate --excludeProtected data-to-code-prod-ui/src
RUN typedoc --mode file --out docs/source/data-to-code-console --ignoreCompilerErrors  --excludePrivate --excludeProtected data-to-code-console
RUN typedoc --mode file --out docs/source/data-to-code-objects --ignoreCompilerErrors  --excludePrivate --excludeProtected data-to-code-objects
RUN typedoc --mode file --out docs/source/data-to-code-objects-test --ignoreCompilerErrors  --excludePrivate --excludeProtected data-to-code-objects-test

CMD tail -f /dev/null
